---
tags: Combinatorics
---

# 写在前面

最近开始看关于组合序列解析性质的文章, 主要是对数凹和对数凸性质, 其中一个很有用的判别方法就是通过递推关系的归纳得到, 这个方法出现在[^1], 下面来简单介绍一下.

# 基本定义

## 序列的对数性质

-   对数凸: 正实数序列$(a_n)_{n\geq0}$称为对数凸的, 如果$a_n^2\leq a_{n-1}a_{n+1},\ \forall n\geq1$.

-   对数凹: 正实数序列$(a_n)_{n\geq0}$称为对数凹的, 如果$a_n^2\geq a_{n-1}a_{n+1},\ \forall n\geq1$.

-   几何/对数直: 正实数序列$(a_n)_{n\geq0}$称为对数凸的, 如果$a_n^2= a_{n-1}a_{n+1},\ \forall n\geq1$.

-   对数斐波那契: 正实数序列$(a_n)_{n\geq0}$称为Fibonacci的, 如果其中不等式的方向取决于$n$的奇偶性, 这里就以Fibonacci序列为例, 观察下表显然得到性质:

    |  偶   |                  | $2^2\geq1\cdot3$ |                  | $5^2\geq3\cdot8$ |                   |
    | :---: | :--------------: | :--------------: | :--------------: | :--------------: | :---------------: |
    | $a_0$ |      $a_1$       |      $a_2$       |      $a_3$       |      $a_4$       |       $a_5$       |
    |  $1$  |       $1$        |       $2$        |       $3$        |       $5$        |        $8$        |
    |  奇   | $1^2\leq1\cdot2$ |                  | $3^2\leq2\cdot5$ |                  | $8^2\leq5\cdot13$ |

-   对数平衡: 正实数序列$(a_n)_{n\geq0}$称为对数平衡的, 如果$(a_n)_{n\geq0}$是对数凸的并且$(a_n/n!)_{n\geq0}$是对数凹的.

## 商序列与对数性质的定义

>   商序列: $(x_n)_{n\geq1},x_n=a_n/a_{n-1}$, 叫做序列$(a_n)_{n\geq0}$的商序列.

-   对数凸: 其商序列非降.
-   对数凹: 其商序列非增.
-   对数斐波那契: 商序列中没有三个连续的元素形成单调子序列. 
-   对数平衡: $x_n\leq x_{n+1}((n+1)/n)x_n,\ \forall n\geq1$.

# 递推关系

令$(a_n)_{n\geq0}$为一正实数序列, 若序列满足下面的三项递推关系:
$$
a_n=R(n)a_{n-1}+S(n)a_{n-2},\quad n\geq2,\tag{1}
$$
初始条件为$a_0,a_1$, 商序列$(x_n)_{n\geq1}$满足下面的非线性递推关系:
$$
x_n=R(n)+\frac{S(n)}{x_{n-1}},\quad n\geq2,\tag{2}
$$
初始条件为$a_1=a_1/a_0$.

假定序列$(x_n)$由两已知序列作为边界, 即序列$(m_n)$和$(M_n)$使得$0<m_n\leq x_n\leq M_n,\ \forall n\in \mathbb N$. 

>   序列$(m_n)$和$(M_n)$通常可以相当容易地从$(2)$中推断出来，或者从序列$(x_n)$的初始行为中猜测出来，然后通过归纳来验证边界关系。在许多情况下，即使常数序列$m_n = m$和$M_n=M$对于$x_n$来说也是足够好的上下界。

假设$R(n)\geq0$, 并且$S(n)\leq0$和$S(n)\geq0$为两种独立的情况.

下面先考虑$S(n)\leq0$.

归纳假设: $x_{n_0}\leq x_{n_{0}+1}\leq\cdots\leq x_n,\forall n_0\in \mathbb N$. 

由$(2)$得:
$$
x_{n+1}=R(n+1)+\frac{S(n+1)}{x_{n}},
$$
考虑:
$$
S(n+1)/x_n\geq S(n+1)/x_{n-1},
$$
得到:
$$
x_{n+1}=R(n+1)+\frac{S(n+1)}{x_{n}}\geq R(n+1)+\frac{S(n+1)}{x_{n-1}},
$$
要证明对数凸性质, 只需证明$x_{n+1}\geq x_n$, 考虑:
$$
R(n+1)+\frac{S(n+1)}{x_{n-1}}\geq x_n=R(n)+\frac{S(n)}{x_{n-1}},
$$
整理得:
$$
[R(n+1)-R(n)]x_{n-1}+S(n+1)-S_{n-1}\geq0,
$$
记$R(n+1)-R(n)=\nabla R(n)$, $S(n+1)-S(n)=\nabla S(n)$, 得到:
$$
\nabla R(n)x_{n-1}+\nabla S(n)\geq0,\quad n\geq n_0,\forall n_0\in \mathbb{N}.\tag{3}
$$
这是一个条件较强的结论. 

---

下面是一个更一般的情况, 即$R(n)$非降情形, 通过假设$\nabla R(n)\geq0$, 替换$x_{n-1}$为$m_{n-1}$, 或者更一般地用常数$m$代替, 条件$(3)$可以进一步简化为
$$
\nabla R(n)m+\nabla S(n)\geq0,\quad n\geq n_0.
$$
$S(n)\geq0$情况略显复杂. 首先递归假设$x_{n_0}\leq x_{n_{0}+1}\leq\cdots\leq x_n,\forall n_0\in \mathbb N$, 我们想要证明$x_{n+1}\geq x_n$, 应用$(2)$式, 得到:
$$
R(n+1)+\frac{S(n+1)}{x_{n-1}}\geq R(n)+\frac{S(n)}{x_{n-1}},
$$
上式等价于:
$$
x_nx_{n-1}\nabla R(n)+S(n-1)x_{n-1}-S(n)x_n\geq0,
$$
左端添加$S(n)x_{n-1}-S(n)x_{n-1}$, 整理得到
$$
x_{n-1}[\nabla R(n)x_n+\nabla S(n)]\geq S(n)(x_n-x_{n-1}),\tag{4}
$$
再由$(2)$式, 
$$
x_n-x_{n-1}=R(n)+\frac{S(n)}{x_{n-1}}-R(n-1)-\frac{S(n-1)}{x_{n-2}},
$$
代入$(4)$, 得到:
$$
x_{n-1}[\nabla R(n)x_n+\nabla S(n)]\geq S(n)\left[\nabla R(n-1)+\frac{S(n)}{x_{n-1}}-\frac{S(n-1)}{x_{n-2}}\right],
$$
将右边的$S(n)/x_{n-1}$替换为$S(n)/x_{n-2}$,(由归纳假设) 
$$
x_{n-1}x_{n-2}[\nabla R(n)+\nabla S(n)]\geq S(n)\left[\nabla R(n-1)x_{n-2}+\nabla S(n-1)\right],\tag{5}
$$
上式也作为一个判断序列对数凸的充分条件. 

上式可以简化为:
$$
m^2[m\nabla R(n)+\nabla S(n)]\geq S(n)\left[M\nabla R(n-1)+\nabla S(n-1)\right],\tag{5}
$$



## 例子

Apéry数:
$$
\begin{aligned}
A_n&=\sum_{k=0}^n\binom nk^2\binom{n+k}k^2=\sum_{k=0}^n\frac{[{(n+k)!}]^2}{(k!)^4[{(n-k)!}]^2},\\
B_n&=\sum_{k=0}^n\binom nk^2\binom{n+k}k=\sum_{k=0}^n\frac{(n+k)!}{(k!)^3[{(n-k)!}]^2},\\
\end{aligned}
$$

取$m=1$作为$x_n$的下界, 则
$$
\nabla R(n)m+\nabla S(n)=\frac{4 \left(12 n^4+12 n^3-3 n^2-3 n+1\right)}{n^3 (n+1)^3}
$$



显然上述序列为一恒大于等于0的序列, 因此我们证明了Apéry数的对数凸性质.

# 参考

[^1]:[Log-balanced combinatorial sequences (hindawi.com)](https://www.hindawi.com/journals/ijmms/2005/741952/);

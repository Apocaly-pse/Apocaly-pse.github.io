---
tags: Tips
---

# 写在前面

今天上课使用了钉钉的直播功能, 想要录屏却发现效果不好, obsCPU过载严重, 调整好之后也收效甚微, 正好听同学说钉钉上课的话有直播回放, 但是不能下载, 这让我十分不爽, 开始Google!



# 大致思路

还真找到了很不错的解决方案, 参考[^1]. 大致方法就是

1.   下载安装Mac下使用的抓包工具`Charles`, 当然这个软件是付费的, 可以通过一些特殊手段进行安装;

2.   配置Charles, 需要安装证书, 信任证书, 然后开启代理;

3.   打开钉钉开启直播回放然后看Charles的抓包情况, 找后缀是`m3u8`的链接然后复制下来;

4.   通过`brew`下载`ffmpqg`这个强大的视频处理工具, 然后执行

     ```bash
     ffmpeg -i <刚才的视频链接> aa.mp4
     ```

     即可完成下载.

具体的部分这里就不列举了, 原文写的很详细了. 





# 需要注意的地方

1.   我电脑是`m1`的MacBook Air, CPU8核, 运行的时候全部跑满, 烫的不行, 后来找到了解决方案, 添加线程数限制`-threads 3`, 参考了[^2][^3]. 就可以以43%左右的CPU占用下载视频并进行合并等操作了. 
2.   注意Charles开启代理之后, 如果关闭Charles电脑就不能联网了, 需要记得用完之后关掉Mac全局代理. 





# 主要参考

[^1]:[Charles 抓包下载钉钉群直播视频 - 端小强的博客 (strongduanmu.com)](https://strongduanmu.com/blog/download-ding-talk-video-by-charles/);
[^2]:[c# - How can I limit FFMpeg CPU usage? - Stack Overflow](https://stackoverflow.com/questions/4565567/how-can-i-limit-ffmpeg-cpu-usage);
[^3]:[FFmpeg限制CPU的使用率，使用“-threads 2” - yuanloo - 博客园 (cnblogs.com)](https://www.cnblogs.com/yuanloo/p/4366194.html);